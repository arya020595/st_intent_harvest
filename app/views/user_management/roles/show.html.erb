<%= turbo_frame_tag "modal" do %>
  <div class="modal-header bg-primary text-white">
    <h5 class="modal-title" id="roleModalLabel">
      <i class="bi bi-shield-check"></i> Role Details
    </h5>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
  </div>
  <div class="modal-body">
    <div class="row mb-3">
      <div class="col-md-12">
        <div class="card border-0 shadow-sm">
          <div class="card-body">
            <dl class="row mb-0">
              <dt class="col-sm-4 text-muted">
                <i class="bi bi-tag"></i> Role Name:
              </dt>
              <dd class="col-sm-8 fw-semibold">
                <%= @role.name %>
              </dd>
              <dt class="col-sm-4 text-muted">
                <i class="bi bi-text-paragraph"></i> Description:
              </dt>
              <dd class="col-sm-8">
                <%= @role.description.presence || '<span class="text-muted">No description</span>'.html_safe %>
              </dd>
              <dt class="col-sm-4 text-muted">
                <i class="bi bi-people"></i> Users Count:
              </dt>
              <dd class="col-sm-8">
                <span class="badge bg-info"><%= @role.users.count %></span>
              </dd>
              <dt class="col-sm-4 text-muted">
                <i class="bi bi-calendar-check"></i> Created At:
              </dt>
              <dd class="col-sm-8">
                <%= @role.created_at.strftime("%B %d, %Y at %I:%M %p") %>
              </dd>
              <dt class="col-sm-4 text-muted">
                <i class="bi bi-calendar-event"></i> Updated At:
              </dt>
              <dd class="col-sm-8">
                <%= @role.updated_at.strftime("%B %d, %Y at %I:%M %p") %>
              </dd>
            </dl>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <h6 class="text-primary mb-3">
          <i class="bi bi-key"></i> Permissions (<%= @role.permissions.count %>)
        </h6>
        <% if @role.permissions.any? %>
          <div class="border rounded p-3" style="max-height: 400px; overflow-y: auto; background-color: #f8f9fa;">
            <% @role.permissions.group_by(&:resource).sort.each do |resource, permissions| %>
              <div class="mb-3">
                <h6 class="text-secondary mb-2">
                  <i class="bi bi-folder"></i> <%= resource.titleize %>
                </h6>
                <div class="ms-3">
                  <% permissions.each do |permission| %>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" checked disabled>
                      <label class="form-check-label text-muted">
                        <%= permission.name %> <small class="text-muted">(#{permission.code})</small>
                      </label>
                    </div>
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
        <% else %>
          <div class="alert alert-warning" role="alert">
            <i class="bi bi-exclamation-triangle"></i> No permissions assigned to this role.
          </div>
        <% end %>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
      <i class="bi bi-x-circle"></i> Close
    </button>
    <%= link_to edit_user_management_role_path(@role), class: "btn btn-warning", data: { turbo_frame: 'modal' } do %>
      <i class="bi bi-pencil"></i> Edit
    <% end %>
    <%= link_to user_management_role_path(@role), data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete #{@role.name}?" }, class: "btn btn-danger" do %>
      <i class="bi bi-trash"></i> Delete
    <% end %>
  </div>
<% end %>
