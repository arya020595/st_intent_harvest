<!-- Worker Details Section -->
<div class="mb-5 mt-5" data-work-order-form-target="workersSection">
  <div class="card-header border-bottom pb-2">
    <div class="fw-bold fs-4" style="color: #155e1a">Worker Details</div>
  </div>
  <div class="d-flex justify-content-end mt-3">
    <button type="button" class="btn btn-success btn-sm p-2 fs-6 fw-bold" data-action="click->work-order-form#addWorker" style="background-color: #155e1a">
      <i class="bi bi-plus-circle-fill text-white me-1"></i> Add Worker
    </button>
  </div>
  <div class="card-body mt-3">
    <div class="table-responsive">
      <table class="table table-hover table-sm mb-0">
        <thead class="table-success">
          <tr>
            <th style="width: 30%">Worker Name</th>
            <th style="width: 15%" data-work-order-form-target="quantityHeader">Quantity(Ha)</th>
            <th style="width: 15%">Rate (RM)</th>
            <th style="width: 15%">Amount (RM)</th>
            <th style="width: 20%">Remarks</th>
            <th style="width: 5%" class="text-center">Action</th>
          </tr>
        </thead>
        <tbody id="workers-tbody" data-work-order-form-target="workersContainer">
          <% work_order.work_order_workers.each_with_index do |wow, index| %>
            <tr data-worker-index="<%= index %>">
              <td>
                <select class="form-select form-select-sm" name="work_order[work_order_workers_attributes][<%= index %>][worker_id]" data-action="change->work-order-form#updateWorkerDetails" data-worker-index="<%= index %>">
                  <option value="">Select Worker</option>
                  <% @workers.each do |w| %>
                    <option value="<%= w.id %>" <%= 'selected' if w.id == wow.worker_id %>><%= w.name %></option>
                    <% end %>
                  </select>
                  <%= hidden_field_tag "work_order[work_order_workers_attributes][#{index}][id]", wow.id %>
                </td>
                <td>
                  <input type="number" class="form-control form-control-sm" id="worker_quantity_<%= index %>" name="work_order[work_order_workers_attributes][<%= index %>][work_area_size]" placeholder="0" step="0.01" min="0" value="<%= wow.work_area_size %>" data-action="input->work-order-form#calculateWorkerAmount" data-worker-index="<%= index %>">
                </td>
                <td>
                  <input type="text" class="form-control form-control-sm" id="worker_rate_<%= index %>" value="<%= wow.rate ? number_to_currency(wow.rate, unit: '', precision: 2) : 'Auto Calculate' %>" disabled style="background-color: #e9ecef;">
                  <input type="hidden" id="worker_rate_value_<%= index %>" name="work_order[work_order_workers_attributes][<%= index %>][rate]" value="<%= wow.rate || 0 %>">
                </td>
                <td>
                  <input type="text" class="form-control form-control-sm" id="worker_amount_<%= index %>" value="<%= wow.amount ? number_to_currency(wow.amount, unit: '', precision: 2) : 'Auto Calculate' %>" disabled style="background-color: #e9ecef;">
                  <input type="hidden" id="worker_amount_value_<%= index %>" name="work_order[work_order_workers_attributes][<%= index %>][amount]" value="<%= wow.amount || 0 %>">
                </td>
                <td>
                  <input type="text" class="form-control form-control-sm" name="work_order[work_order_workers_attributes][<%= index %>][remarks]" placeholder="Remarks" value="<%= wow.remarks %>">
                </td>
                <input type="hidden" id="worker_destroy_<%= index %>" name="work_order[work_order_workers_attributes][<%= index %>][_destroy]" value="0">
                <td class="text-center">
                  <button type="button" class="btn btn-danger btn-sm" data-action="click->work-order-form#removeWorker" data-worker-index="<%= index %>">
                    <i class="bi bi-trash me-1 text-white"></i>
                  </button>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
