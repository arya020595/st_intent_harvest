<div class="payslip-page">
  <h1>Payslip</h1>
  <div class="row">
    <!-- LEFT SIDE: FILTERS -->
    <div class="col-md-3">
      <div class="card p-3">
        <h4>Payslip Filter</h4>
        <hr/>
        <%= form_with url: payslips_path, method: :get, local: true do |f| %>
          <div class="form-group mt-2">
            <%= f.label :month, "Month" %>
            <% available_months = PayCalculation.distinct.pluck(:month_year).map { |d| Date.parse(d + '-01').month }.uniq.sort %>
            <%= f.select :month,
      available_months.map { |m| [Date::MONTHNAMES[m], m] },
      { selected: params[:month] },
      class: "form-control" %>
          </div>
          <div class="form-group mt-2">
            <%= f.label :year, "Year" %>
            <% available_years = PayCalculation.distinct.pluck(:month_year).map { |d| Date.parse(d + '-01').year }.uniq.sort %>
            <%= f.select :year,
      available_years,
      { selected: params[:year] },
      class: "form-control" %>
          </div>
          <div class="form-group mt-2">
            <%= f.label :worker_id, "Worker" %>
            <%= f.collection_select :worker_id,
                  Worker.all,
                  :id,
                  :name,
                  { selected: params[:worker_id] },
                  class: "form-control" %>
          </div>
          <%= f.submit "Generate", class: "btn btn-success w-100 mt-3" %>
        <% end %>
      </div>
    </div>
    <!-- RIGHT SIDE: PDF VIEWER -->
    <div class="col-md-9">
      <div class="card p-3" style="text-align: center;">
        <% if @payslip_pdf_url.present? %>
          <iframe src="<%= @payslip_pdf_url %>"
                  width="100%" height="500px"
                  style="border: 1px solid #ccc;">
          </iframe>
        <% else %>
          <%= image_tag "clipboard-icon.png",
                alt: "No Payslip Selected",
                style: "display: block; margin: 0 auto;",
                width: "100px",
                height: "100px" %>
          <p class="text-muted mt-4">
            Select options from the filter fields on the left to generate a report.
          </p>
        <% end %>
      </div>
    </div>
  </div>
</div>
